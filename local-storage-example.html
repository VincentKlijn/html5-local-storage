<!DOCTYPE HTML>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="description" content="Local Storage Example">
	<meta name="viewport" content="width=device-width, user-scalable=no">
    <title>localStorage example</title>
	<!-- External stylesheet for all pages -->
    <link rel="stylesheet" type="text/css" href="css/main.css">
	<!-- External js library for all examples -->
    <script language="javascript" src="javascript/vkHTML5LocalStorage.js"></script>
	
	<!-- internal js specific for this example file -->
    <script language="javascript">

		// check for local storage support within the client
		// if we have that, create a var db to hold the data
 		var db = getLocalStorage() || dispError("Local Storage not supported");
		
		// Local Storage CRUD
		// .localStorage initiates the local storage db
		// .getItem() reads an element from local storage db
		// .setItem() sets an element in local storage db
		// .removeItem() removes an element from local storage db
		// .clear() clears all elements from the local storage db
		
		// put the results of local storage on screen
        function dispResults() {
            if(errorMessage) {
                myElement('results').innerHTML = errorMessage;
                return;
            }

			// build a new table to display below the form
			var tbl = new myTable();
			tbl.addRow( ["Traveler", db.getItem("traveler")] );			
			tbl.addRow( ["Destination", db.getItem("destination")] );			
			tbl.addRow( ["Transportation", db.getItem("transportation")] );			
 
			// within div#results put the tbl we have put together
			myElement('results').innerHTML = tbl.getTableHTML();
        }

		// when Go is pressed
        function dbGo() {
			// errorMessage gets set while checking of local storage is available
			// here we use this to stop the function when Go is pressed without db
            if(errorMessage) {
				return;
			}

			// read the form which has three text fields
 			var pageForm = myElement("travelForm");
			db.setItem("traveler", pageForm.elements["traveler"].value);
			db.setItem("destination", pageForm.elements["destination"].value);
			db.setItem("transportation", pageForm.elements["transportation"].value);
			// execute dispResults
            dispResults();
        }
		
		// when Clear is pressed
		function dbClear() {
            if(errorMessage) {
				return;
			}
			db.clear();
			dispResults();
		}

		// initiates script once window is loaded
        window.onload = function() {
            dispResults();
        }
    </script>
</head>

<body>
	<div id="content">

		<h1>localStorage example</h1>
		
		<!-- the form used for data entry -->
		<div id="form">
			<form id="travelForm">
				<table class="form">
					<!-- the three text fields -->
					<tr><td class="label"> Traveler </td><td> <input type="text" name="traveler" /> </td></tr>
					<tr><td class="label"> Destination </td><td> <input type="text" name="destination" /> </td></tr>
					<tr><td class="label"> Transportation </td><td> <input type="text" name="transportation" /> </td></tr>
					<!-- the two buttons Clear & Go -->
					<tr><td colspan="2" class="button">
						<input id="formSubmit1" type="button" value="Clear" onClick="javascript:dbClear()" />
						<input id="formSubmit2" type="button" value="Go" onClick="javascript:dbGo()" />
					</td></tr>
				</table>
 			</form>
		</div>
		
		<div id="results">
		<!-- results are shown here -->
		</div>
		
	</div>
</body>
</html>
